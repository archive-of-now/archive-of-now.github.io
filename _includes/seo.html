{%- comment -%}
  SEO partial
  Features:
    • canonical, description, keywords (deduped)
    • Open Graph + Twitter cards
    • published / updated times
    • author integration
{%- endcomment -%}

{%- assign canonical_url = site.url | append: site.baseurl | append: page.url -%}
{%- assign seo_title = page.seo.title | default: page.title | default: site.title -%}
{%- assign seo_description = page.seo.description | default: page.description | default: page.excerpt | default: site.description -%}
{%- assign seo_type = page.seo.type | default: "article" -%}
{%- assign seo_image = page.seo.image | default: page.image -%}

{%- comment -%}Merge & deduplicate keyword sources{%- endcomment -%}
{%- assign keyword_list = page.keywords | default: empty -%}
{%- assign tag_list = page.tags | default: empty -%}
{%- assign all_keywords = keyword_list | concat: tag_list | uniq | join: ", " -%}

{%- comment -%}Author handling (list → string → fallback){%- endcomment -%}
{%- assign authors = site.authors | join: ", " | default: site.author.name -%}

<title>{{ seo_title }}</title>
<meta name="description" content="{{ seo_description | strip_newlines | escape }}">
<link rel="canonical" href="{{ canonical_url | replace: 'index.html','' }}">
<meta name="keywords" content="{{ all_keywords }}">

<meta property="og:title" content="{{ seo_title }}">
<meta property="og:description" content="{{ seo_description | strip_newlines | escape }}">
<meta property="og:type" content="{{ seo_type }}">
<meta property="og:url" content="{{ canonical_url | replace: 'index.html','' }}">
<meta property="og:site_name" content="{{ site.title }}">
{%- if seo_image -%}
<meta property="og:image" content="{{ seo_image | absolute_url }}">
{%- endif -%}

{%- if authors -%}
<meta name="author" content="{{ authors }}">
<meta property="article:author" content="{{ authors }}">
{%- endif -%}

{%- if page.date -%}
<meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
{%- endif -%}
{%- if page.last_modified_at -%}
<meta property="article:modified_time" content="{{ page.last_modified_at | date_to_xmlschema }}">
{%- endif -%}

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ seo_title }}">
<meta name="twitter:description" content="{{ seo_description | strip_newlines | escape }}">
{%- if seo_image -%}
<meta name="twitter:image" content="{{ seo_image | absolute_url }}">
{%- endif -%}
